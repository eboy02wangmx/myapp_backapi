<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC
    "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="jp.co.myapp.api.domain.repository.album.AlbumRepository">

	<select id="getAlbum" parameterType="String" resultType="jp.co.myapp.api.domain.model.AlbumBean">
    	SELECT
		    vi.filename,
		    vi.bukenme,
		    vi.userid,
		    vi.shoyusha,
		    vi.yukokbn,
		    vi.sakusesha,
		    vi.sakusehi,
		    vi.koushinsha,
		    vi.koushinhi,
		    vi.picnum,
		    ui.customid
		FROM
		    innodb.vr_info vi
		        LEFT JOIN
		    innodb.user_info ui ON vi.userid = ui.userid
		WHERE
		    ui.customid = (SELECT
		            customid
		        FROM
		            user_info
		        WHERE
		            userid = #{userid})
		    and vi.yukokbn = '1'
	</select>

	<select id="getRiyo" parameterType="String" resultType="jp.co.myapp.api.domain.model.AlbumBean">
    	SELECT
		    vi.filename,
		    vi.bukenme,
		    vi.userid,
		    vi.shoyusha,
		    vi.yukokbn,
		    vi.sakusesha,
		    vi.sakusehi,
		    vi.koushinsha,
		    vi.koushinhi,
		    vi.picnum,
		    ui.customid
		FROM
		    innodb.vr_info vi
		        LEFT JOIN
		    innodb.user_info ui ON vi.userid = ui.userid
	</select>

	<delete id="removeAlbum" parameterType="String">
	delete from innodb.vr_info where filename = #{filename}
	</delete>

	<update id="editAlbum" parameterType = "jp.co.myapp.api.domain.model.AlbumBean">
	update innodb.vr_info set
	filename = #{album.filename},
	bukenme = #{album.bukenme},
	shoyusha = #{album.shoyusha},
	yukokbn = #{album.yukokbn},
	sakusesha = #{album.sakusesha},
    sakusehi = #{album.sakusehi},
	koushinsha = #{album.koushinsha},
	koushinhi = #{album.koushinhi},
	picnum where userid = #{album.userid}

	</update>

	<insert id="createAlbum" parameterType = "jp.co.myapp.api.app.request.AlbumCreateRequest">
	insert into innodb.vr_info
		(
		filename,
		bukenme,
		userid,
		sakusehi,
		koushinhi,
		picnum
		)
	values
		(
		NOW(),
		#{bukenme},
		#{userid},
		#{sakusehi},
		#{koushinhi},
		0
		)

	</insert>

	<update id="riiyoEff"  parameterType = "String">



	</update>
</mapper>
